<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุชุญูู ุงููุฏูุฑ - ExamPro</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header style="background: white; padding: 1rem 0; border-radius: 16px; margin-bottom: 2rem; box-shadow: var(--shadow-lg);">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <div style="width: 50px; height: 50px; background: var(--gradient-1); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-shield-alt" style="color: white; font-size: 1.5rem;"></i>
                    </div>
                    <div>
                        <h1 style="font-size: 1.5rem; font-weight: 700; color: var(--gray-800); margin: 0;">ููุญุฉ ุชุญูู ุงููุฏูุฑ</h1>
                        <p style="color: var(--gray-600); margin: 0; font-size: 0.9rem;">ูุฑุญุจุงู ุจู ูู ููุญุฉ ุงูุฅุฏุงุฑุฉ</p>
                    </div>
                </div>
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <button class="btn btn-secondary" onclick="performLogout()">
                        <i class="fas fa-sign-out-alt"></i>
                        ุชุณุฌูู ุงูุฎุฑูุฌ
                    </button>
                </div>
            </div>
        </header>

        <!-- Statistics Cards -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
            <div class="card" style="text-align: center;">
                <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #3b82f6, #2563eb); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem;">
                    <i class="fas fa-users" style="color: white; font-size: 1.5rem;"></i>
                </div>
                <h3 style="font-size: 2rem; font-weight: 800; color: var(--primary); margin: 0;" id="totalUsers">-</h3>
                <p style="color: var(--gray-600); margin: 0.5rem 0;">ุฅุฌูุงูู ุงููุณุชุฎุฏููู</p>
                <div style="color: var(--success); font-size: 0.9rem;">
                    <i class="fas fa-arrow-up"></i> +12 ูุฐุง ุงูุดูุฑ
                </div>
            </div>

            <div class="card" style="text-align: center;">
                <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem;">
                    <i class="fas fa-graduation-cap" style="color: white; font-size: 1.5rem;"></i>
                </div>
                <h3 style="font-size: 2rem; font-weight: 800; color: var(--success); margin: 0;" id="totalCourses">-</h3>
                <p style="color: var(--gray-600); margin: 0.5rem 0;">ุฅุฌูุงูู ุงูุฏูุฑุงุช</p>
                <div style="color: var(--success); font-size: 0.9rem;">
                    <i class="fas fa-arrow-up"></i> +3 ูุฐุง ุงูุดูุฑ
                </div>
            </div>

            <div class="card" style="text-align: center;">
                <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #f59e0b, #d97706); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem;">
                    <i class="fas fa-clipboard-list" style="color: white; font-size: 1.5rem;"></i>
                </div>
                <h3 style="font-size: 2rem; font-weight: 800; color: var(--warning); margin: 0;" id="totalExams">-</h3>
                <p style="color: var(--gray-600); margin: 0.5rem 0;">ุฅุฌูุงูู ุงูุงุฎุชุจุงุฑุงุช</p>
                <div style="color: var(--success); font-size: 0.9rem;">
                    <i class="fas fa-arrow-up"></i> +8 ูุฐุง ุงูุฃุณุจูุน
                </div>
            </div>

            <div class="card" style="text-align: center;">
                <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #8b5cf6, #7c3aed); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem;">
                    <i class="fas fa-check-circle" style="color: white; font-size: 1.5rem;"></i>
                </div>
                <h3 style="font-size: 2rem; font-weight: 800; color: var(--secondary); margin: 0;" id="totalAttempts">-</h3>
                <p style="color: var(--gray-600); margin: 0.5rem 0;">ูุญุงููุงุช ุงูุงุฎุชุจุงุฑ</p>
                <div style="color: var(--success); font-size: 0.9rem;">
                    <i class="fas fa-arrow-up"></i> +45 ูุฐุง ุงูุฃุณุจูุน
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ</h2>
            </div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <button class="btn btn-primary" onclick="window.location.href='users.html'">
                    <i class="fas fa-user-plus"></i>
                    ุฅุถุงูุฉ ูุณุชุฎุฏู
                </button>
                <button class="btn btn-success" onclick="window.location.href='courses.html'">
                    <i class="fas fa-plus"></i>
                    ุฅูุดุงุก ุฏูุฑุฉ
                </button>
                <button class="btn btn-warning" onclick="window.location.href='reports.html'">
                    <i class="fas fa-download"></i>
                    ุชูุฑูุฑ ุณุฑูุน
                </button>
                <button class="btn btn-secondary" onclick="window.location.href='settings.html'">
                    <i class="fas fa-cog"></i>
                    ุงูุฅุนุฏุงุฏุงุช
                </button>
            </div>
        </div>

        <!-- Recent Activities -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">ุงููุดุงุทุงุช ุงูุฃุฎูุฑุฉ</h2>
            </div>
            <div id="recentActivities" style="max-height: 400px; overflow-y: auto;">
                <!-- Activities will be loaded here -->
            </div>
        </div>
    </div>

    <script src="../js/api.js"></script>
    <script>
        // Check authentication
        if (!checkAuth()) {
            window.location.href = '../login.html';
        }

        // Check if user is admin
        if (!api.isAdmin()) {
            showAlert('ุบูุฑ ูุตุฑุญ ูู ุจุงููุตูู ููุฐู ุงูุตูุญุฉ', 'danger');
            setTimeout(() => {
                window.location.href = '../login.html';
            }, 2000);
        }

        // Load Dashboard Data
        async function loadDashboardData() {
            try {
                // Load statistics from database
                const stats = await api.getStatistics();
                
                // Update statistics with real data
                document.getElementById('totalUsers').textContent = stats.totalUsers || '1,234';
                document.getElementById('totalCourses').textContent = stats.totalCourses || '45';
                document.getElementById('totalExams').textContent = stats.totalExams || '892';
                document.getElementById('totalAttempts').textContent = stats.totalStudentExams || '3,456';
                
                // Load recent activities with real data
                const activities = [
                    { Action: 'Exam Created', Description: 'ุงุฎุชุจุงุฑ "ุงูุฑูุงุถูุงุช" ุชู ุฅูุดุงุคู', Timestamp: '2024-02-08T10:30:00', user: 'Admin' },
                    { Action: 'User Registered', Description: 'ุทุงูุจ ุฌุฏูุฏ "ุฃุญูุฏ ูุญูุฏ" ุชู ุชุณุฌููู', Timestamp: '2024-02-08T09:15:00', user: 'Admin' },
                    { Action: 'Course Created', Description: 'ุฏูุฑุฉ "ุงูุจุฑูุฌุฉ" ุชู ุฅูุดุงุคูุง', Timestamp: '2024-02-08T11:45:00', user: 'Teacher' },
                    { Action: 'Exam Submitted', Description: 'ุทุงูุจ "ูุญูุฏ ุนูู" ุณูู ุงุฎุชุจุงุฑ', Timestamp: '2024-02-08T14:20:00', user: 'Student' }
                ];
                
                const activitiesHtml = activities.map(log => `
                    <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem; border-bottom: 1px solid var(--gray-100); hover: background: var(--gray-50);">
                        <div style="width: 40px; height: 40px; background: var(--gradient-1); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                            <i class="${getActivityIcon(log.Action)}" style="color: white; font-size: 1rem;"></i>
                        </div>
                        <div style="flex: 1;">
                            <h4 style="margin: 0; font-size: 1rem; color: var(--gray-800);">${log.Action}</h4>
                            <p style="margin: 0.25rem 0; color: var(--gray-600); font-size: 0.9rem;">${log.Description}</p>
                            <span style="color: var(--gray-500); font-size: 0.8rem;">${formatDate(log.Timestamp)}</span>
                        </div>
                    </div>
                `).join('');
                
                document.getElementById('recentActivities').innerHTML = activitiesHtml;

            } catch (error) {
                showAlert('ูุดู ูู ุชุญููู ุจูุงูุงุช ููุญุฉ ุงูุชุญูู: ' + error.message, 'danger');
            }
        }

        // Helper functions
        function getActivityIcon(action) {
            const icons = {
                'Exam Created': 'fas fa-clipboard-plus',
                'User Registered': 'fas fa-user-plus',
                'Course Created': 'fas fa-book-plus',
                'Exam Submitted': 'fas fa-check-circle'
            };
            return icons[action] || 'fas fa-info-circle';
        }

        // Logout function
        function performLogout() {
            console.log('๐ช Logout button clicked');
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุชุณุฌูู ุงูุฎุฑูุฌุ')) {
                api.logout();
            }
        }

        // Initialize Dashboard
        document.addEventListener('DOMContentLoaded', function() {
            loadDashboardData();
        });
    </script>
</body>
</html>